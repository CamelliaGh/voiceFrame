# Task ID: 5
# Title: Implement QR Code Generation
# Status: done
# Dependencies: 3
# Priority: medium
# Description: Create a system to generate QR codes linking to audio files.
# Details:
The QR code generation system is fully implemented and exceeds the original requirements. It includes dual implementation with both ReportLab-based and Visual template generators, integration of the qrcode[pil] library, and high-quality scalable vector QR codes with error correction. QR codes link directly to presigned S3 URLs with appropriate expiration settings for both preview and paid versions. The system includes comprehensive error handling, template-based positioning, transparency support, and advanced features such as background integration.

# Test Strategy:
The implementation includes a dedicated test suite with comprehensive test cases covering expiration testing, error handling, URL generation, and both PDF generators. The system has been tested across different devices to ensure scannability and functionality.

# Subtasks:
## 1. Design watermark layout system [done]
### Dependencies: None
### Description: Create diagonal watermark positioning system across entire poster
### Details:
- Calculate diagonal positioning across poster dimensions
- Ensure watermark covers entire poster area
- Create repeating pattern for large posters
- Test positioning on different page sizes
- Optimize for visual coverage without obstruction

## 2. Implement watermark text rendering [done]
### Dependencies: 5.1
### Description: Create watermark text with specified styling and opacity
### Details:
- Use 'PREVIEW - AudioPoster.com' text content
- Set 20% opacity (#CCCCCC with transparency)
- Apply sans-serif 24pt font
- Ensure text is readable but not obstructive
- Test text scaling for different poster sizes

## 3. Integrate watermark into PDF generation [done]
### Dependencies: 5.2
### Description: Apply watermark during PDF generation process, not as overlay
### Details:
- Embed watermark directly into PDF structure
- Apply watermark before final PDF compilation
- Ensure watermark cannot be easily removed
- Test watermark integration with all templates
- Verify watermark persists through PDF processing

## 4. Test watermark readability and removal difficulty [done]
### Dependencies: 5.3
### Description: Validate that watermark maintains poster readability while being difficult to remove
### Details:
- Test poster content readability with watermark
- Attempt various watermark removal methods
- Ensure watermark doesn't interfere with QR code scanning
- Validate watermark visibility across different backgrounds
- Test watermark on various devices and PDF readers

